# üçÉ MongoDB Datasource –¥–ª—è Grafana

![–í–µ—Ä—Å–∏—è](https://img.shields.io/badge/–≤–µ—Ä—Å–∏—è-0.8.1-blue.svg)
![–õ–∏—Ü–µ–Ω–∑–∏—è](https://img.shields.io/badge/–ª–∏—Ü–µ–Ω–∑–∏—è-MIT-green.svg)
![Grafana](https://img.shields.io/badge/Grafana-3.x%2B-orange.svg)
![MongoDB](https://img.shields.io/badge/MongoDB-3.4%2B-green.svg)

**–ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç–µ MongoDB –≤ –º–æ—â–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Grafana —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π aggregation pipeline**

[–†—É—Å—Å–∫–∏–π] | [English](README.md)

<img src="src/img/sample_dashboard.png" alt="MongoDB Grafana Dashboard" style="width: 800px;"/>

---

## üë®‚Äçüíª –û–± –∞–≤—Ç–æ—Ä–µ –∏ —É—Å–ª—É–≥–∞—Ö

### üéØ DevOps –∏–Ω–∂–µ–Ω–µ—Ä –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

–ü—Ä–∏–≤–µ—Ç! –Ø **Ranas Mukminov**, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Å—å –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

**–ú–æ–∏ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏:**
- üìä **Grafana/Prometheus**: –û—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ enterprise –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- üçÉ **MongoDB**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è, —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
- üê≥ **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker, Podman, Kubernetes
- ü§ñ **Telegram –±–æ—Ç—ã**: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- üîß **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: Ansible, Terraform, CI/CD pipelines
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL/TLS, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞—É–¥–∏—Ç

### üíº –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ —É—Å–ª—É–≥–∏

#### üì¶ –ü–∞–∫–µ—Ç "MongoDB Monitoring Start"

**–ß—Ç–æ –≤—Ö–æ–¥–∏—Ç:**
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Grafana + MongoDB datasource plugin
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB/MongoDB Atlas
- ‚úÖ 3-5 –≥–æ—Ç–æ–≤—ã—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤:
  - Performance metrics (–æ–ø–µ—Ä–∞—Ü–∏–∏, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –ø–∞–º—è—Ç—å)
  - Query analytics (–∞–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤)
  - Replication lag monitoring (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏)
  - Collection statistics (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π)
  - Connection pool monitoring
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ –∞–ª–µ—Ä—Ç—ã (—á–µ—Ä–µ–∑ Telegram/Email)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚úÖ –ö—Ä–∞—Ç–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã (1 —á–∞—Å)

**–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:** –º–∞–ª—ã–π/—Å—Ä–µ–¥–Ω–∏–π –±–∏–∑–Ω–µ—Å, —Å—Ç–∞—Ä—Ç–∞–ø—ã, —Ç–µ—Å—Ç–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 1-2 –¥–Ω—è

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** –æ—Ç **20,000‚ÇΩ**

---

#### üöÄ –ü–∞–∫–µ—Ç "MongoDB Enterprise Monitoring"

**–ß—Ç–æ –≤—Ö–æ–¥–∏—Ç:**
- ‚úÖ –ü–æ–ª–Ω—ã–π —Å—Ç–µ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Grafana + Prometheus + Exporters)
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –ø–æ–¥ –≤–∞—à–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ replica sets –∏ sharded clusters
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤:
  - Replication lag –ø—Ä–µ–≤—ã—à–∞–µ—Ç threshold
  - Connection pool exhaustion
  - Slow queries detection (–≤—ã—è–≤–ª–µ–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
  - Disk space prediction (–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞)
  - Memory usage alerts
  - CPU –∏ I/O –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã (4 —á–∞—Å–∞)
- ‚úÖ –ú–µ—Å—è—Ü —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏

**–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:** —Å—Ä–µ–¥–Ω–∏–π/–∫—Ä—É–ø–Ω—ã–π –±–∏–∑–Ω–µ—Å, e-commerce, SaaS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 3-5 –¥–Ω–µ–π

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** –æ—Ç **50,000‚ÇΩ**

---

#### üè¢ –ü–∞–∫–µ—Ç "MongoDB Monitoring Cluster"

**–ß—Ç–æ –≤—Ö–æ–¥–∏—Ç:**
- ‚úÖ High Availability –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∞—Å—Ç–µ—Ä (–æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)
- ‚úÖ Multi-region –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–æ–≤)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MongoDB Ops Manager/Cloud Manager
- ‚úÖ Custom exporters –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞
- ‚úÖ Machine Learning –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º
- ‚úÖ Automated remediation scripts (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ITSM —Å–∏—Å—Ç–µ–º–∞–º–∏ (Jira, ServiceNow)
- ‚úÖ 24/7 alerting —Å–∏—Å—Ç–µ–º–∞ —Å —ç—Å–∫–∞–ª–∞—Ü–∏–µ–π
- ‚úÖ Performance baseline –∏ capacity planning
- ‚úÖ SLA monitoring –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- ‚úÖ Backup monitoring –∏ disaster recovery
- ‚úÖ Security audit –∏ compliance –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (3-12 –º–µ—Å—è—Ü–µ–≤)

**–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:** enterprise –∫–æ–º–ø–∞–Ω–∏–∏, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Å–µ–∫—Ç–æ—Ä, –∫—Ä–∏—Ç–∏—á–Ω—ã–µ SaaS, high-load –ø—Ä–æ–µ–∫—Ç—ã

**–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2-4 –Ω–µ–¥–µ–ª–∏

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** –æ—Ç **150,000‚ÇΩ**

---

### üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

#### üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏

| –£—Å–ª—É–≥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|--------|----------|-----------|
| **–†–∞–∑–æ–≤–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è** | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø–æ MongoDB/Grafana (1 —á–∞—Å) | **5,000‚ÇΩ** |
| **–ê—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** | –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ | –æ—Ç **15,000‚ÇΩ** |
| **Performance troubleshooting** | –ü–æ–∏—Å–∫ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | –æ—Ç **10,000‚ÇΩ/—á–∞—Å** |
| **–ú–∏–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è** | –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ MongoDB + Grafana –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | –æ—Ç **30,000‚ÇΩ** |

#### üìö –û–±—É—á–µ–Ω–∏–µ

| –ö—É—Ä—Å | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|------|-------------------|-----------|
| **"MongoDB –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å Grafana"** | 8 —á–∞—Å–æ–≤ (2 –¥–Ω—è –ø–æ 4 —á–∞—Å–∞) | **40,000‚ÇΩ** |
| **"Grafana –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤"** | 16 —á–∞—Å–æ–≤ (4 –¥–Ω—è) | **80,000‚ÇΩ** |
| **"MongoDB Performance Optimization"** | 12 —á–∞—Å–æ–≤ | **60,000‚ÇΩ** |
| **–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** | –ü–æ –ø—Ä–æ–≥—Ä–∞–º–º–µ –∫–ª–∏–µ–Ω—Ç–∞ | –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ |

#### üíª –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

| –£—Å–ª—É–≥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|--------|----------|-----------|
| **Custom Grafana plugin** | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞–≥–∏–Ω–∞ –ø–æ–¥ –≤–∞—à–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è | –æ—Ç **100,000‚ÇΩ** |
| **Telegram –±–æ—Ç —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º** | –ë–æ—Ç –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –æ—Ç **30,000‚ÇΩ** |
| **Integration scripts** | –°–∫—Ä–∏–ø—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ | –æ—Ç **20,000‚ÇΩ** |
| **Custom exporter** | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Ç—Ä–∏–∫-—ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–∞ | –æ—Ç **40,000‚ÇΩ** |

---

### üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

<div align="center">

üåê **–°–∞–π—Ç**: [run-as-daemon.ru](https://run-as-daemon.ru)

üìß **Email**: contact@run-as-daemon.ru

üí¨ **Telegram**: @run_as_daemon

üì± **–¢–µ–ª–µ—Ñ–æ–Ω/WhatsApp**: +7 (XXX) XXX-XX-XX

üíº **LinkedIn**: [linkedin.com/in/ranas-mukminov](https://linkedin.com/in/ranas-mukminov)

</div>

**–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã:** –ü–Ω-–ü—Ç 10:00-19:00 –ú–°–ö  
**–≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞:** 24/7 –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –∞–∫—Ç–∏–≤–Ω—ã–º SLA

---

### üèÜ –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∏ –∫–µ–π—Å—ã

#### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã:

**1. E-commerce –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ (MongoDB Sharded Cluster)**
- üîπ 12 —à–∞—Ä–¥–æ–≤, 3 replica sets –ø–æ –∫–∞–∂–¥–æ–º—É —à–∞—Ä–¥—É
- üîπ Grafana + Prometheus + MongoDB exporter
- üîπ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã (DevOps, Backend, Analytics)
- üîπ Telegram –∞–ª–µ—Ä—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- üîπ Automated capacity planning
- üîπ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 99.9% uptime, —Ä–∞–Ω–Ω–µ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∑–∞ 5-10 –º–∏–Ω—É—Ç

**2. SaaS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (MongoDB Atlas)**
- üîπ Multi-region –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (3 —Ä–µ–≥–∏–æ–Ω–∞)
- üîπ Integration —Å Atlas API –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- üîπ –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ—Å—Ç–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π
- üîπ Automated scaling recommendations
- üîπ Cost optimization –¥–∞—à–±–æ—Ä–¥—ã
- üîπ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 40% —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ Atlas, –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π —Ä–æ—Å—Ç

**3. –§–∏–Ω—Ç–µ—Ö —Å—Ç–∞—Ä—Ç–∞–ø (MongoDB + TimescaleDB)**
- üîπ Hybrid –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–∞
- üîπ Real-time query analytics
- üîπ Fraud detection dashboards
- üîπ Integration —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –∞–Ω—Ç–∏—Ñ—Ä–æ–¥ —Å–∏—Å—Ç–µ–º–∞–º–∏
- üîπ Compliance –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å
- üîπ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –∑–∞ —Å–µ–∫—É–Ω–¥—ã, —Å–Ω–∏–∂–µ–Ω–∏–µ fraud –Ω–∞ 35%

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –ø—Ä–æ–µ–∫—Ç–∞—Ö:** [run-as-daemon.ru/cases](https://run-as-daemon.ru/cases)

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–ª–∞–≥–∏–Ω–∞

- üìä **Graph –ø–∞–Ω–µ–ª–∏**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–π MongoDB
- üìã **Table –ø–∞–Ω–µ–ª–∏**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- üîÑ **Template –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –¥–∞—à–±–æ—Ä–¥—ã —Å `$from`, `$to` –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- üì¶ **–ê–≤—Ç–æ-–±–∞–∫–µ—Ç–∏–Ω–≥**: –ú–∞–∫—Ä–æ—Å `$dateBucketCount` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- ‚òÅÔ∏è **MongoDB Atlas**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–ª–∞—á–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- üîå **–ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: REST API proxy –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- üöÄ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ aggregation pipeline –∑–∞–ø—Ä–æ—Å—ã

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Grafana** >= 3.x.x
- **MongoDB** >= 3.4.x
- **Node.js** >= 14.x

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Grafana –ø–ª–∞–≥–∏–Ω–∞

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–ª–∞–≥–∏–Ω –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–ª–∞–≥–∏–Ω–æ–≤ Grafana
cp -r mongodb-grafana /usr/local/var/lib/grafana/plugins/

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Grafana
# –ù–∞ Mac —Å Homebrew:
brew services restart grafana

# –ù–∞ Linux —Å systemd:
sudo systemctl restart grafana-server
```

#### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ MongoDB Proxy —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–ª–∞–≥–∏–Ω–∞
cd /usr/local/var/lib/grafana/plugins/mongodb-grafana

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ proxy —Å–µ—Ä–≤–µ—Ä (—Å–ª—É—à–∞–µ—Ç –Ω–∞ http://localhost:3333)
npm run server
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

1. –í Grafana –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Configuration** ‚Üí **Data Sources**
2. –ù–∞–∂–º–∏—Ç–µ **Add data source**
3. –í—ã–±–µ—Ä–∏—Ç–µ **MongoDB** –∏–∑ —Å–ø–∏—Å–∫–∞
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:

<img src="src/img/sample_datasource.png" alt="–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö" style="width: 500px;"/>

**–ü—Ä–∏–º–µ—Ä MongoDB URL –¥–ª—è Atlas:**
```
mongodb://username:password@cluster.mongodb.net:27017/database?ssl=true&replicaSet=replicaset-name&authSource=admin
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ MongoDB:**
```
mongodb://localhost:27017
```

5. –£–∫–∞–∂–∏—Ç–µ **–∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
6. –ù–∞–∂–º–∏—Ç–µ **Save & Test**

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π –≥—Ä–∞—Ñ–∏–∫ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞—à–±–æ—Ä–¥ –∏–∑ `examples/RPI MongoDB - Atlas.json` –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –ø–∞–Ω–µ–ª—å —Å —ç—Ç–∏–º –∑–∞–ø—Ä–æ—Å–æ–º:

```javascript
db.sensor_value.aggregate([
  { 
    "$match": { 
      "sensor_type": "$sensor", 
      "host_name": "$host", 
      "ts": { "$gte": "$from", "$lte": "$to" } 
    } 
  },
  { "$sort": { "ts": 1 } },
  { 
    "$project": { 
      "name": "value", 
      "value": "$sensor_value", 
      "ts": "$ts", 
      "_id": 0 
    } 
  }
])
```

<img src="src/img/sample_query.png" alt="–†–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤" style="width: 800px;"/>

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:**
- `name` - –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–∏–∏ (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ)
- `value` - –ß–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- `ts` - –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ BSON date

**Template –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `$from` –∏ `$to` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤ BSON –¥–∞—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ Grafana
- `$sensor` –∏ `$host` - –ö–∞—Å—Ç–æ–º–Ω—ã–µ template –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤

### –ü—Ä–∏–º–µ—Ä 2: –ê–≤—Ç–æ-–±–∞–∫–µ—Ç–∏–Ω–≥ —Å $dateBucketCount

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä `$bucketAuto` MongoDB —Å –º–∞–∫—Ä–æ—Å–æ–º `$dateBucketCount` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏:

```javascript
db.sensor_value.aggregate([
  { 
    "$match": { 
      "sensor_type": "$sensor", 
      "host_name": "$host", 
      "ts": { "$gte": "$from", "$lt": "$to" } 
    } 
  },
  { 
    "$bucketAuto": { 
      "groupBy": "$ts", 
      "buckets": "$dateBucketCount", 
      "output": { 
        "maxValue": { "$max": "$sensor_value" },
        "avgValue": { "$avg": "$sensor_value" }
      } 
    } 
  },
  { 
    "$project": { 
      "name": "max_value", 
      "value": "$maxValue", 
      "ts": "$_id.min", 
      "_id": 0 
    } 
  }
])
```

–ü–æ–ª–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ `examples/RPI MongoDB Bucket - Atlas.json`.

### –ü—Ä–∏–º–µ—Ä 3: –¢–∞–±–ª–∏—á–Ω–∞—è –ø–∞–Ω–µ–ª—å

<img src="src/img/table_panel.png" alt="–¢–∞–±–ª–∏—á–Ω–∞—è –ø–∞–Ω–µ–ª—å" style="width: 800px;"/>

–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```javascript
db.sensor_value.aggregate([
  { 
    "$match": { 
      "ts": { "$gte": "$from", "$lt": "$to" } 
    } 
  },
  { 
    "$group": { 
      "_id": { 
        "sensor_name": "$sensor_name", 
        "sensor_type": "$sensor_type" 
      }, 
      "cnt": { "$sum": 1 }, 
      "ts": { "$max": "$ts" } 
    } 
  },
  { 
    "$project": { 
      "name": { 
        "$concat": ["$_id.sensor_name", ":", "$_id.sensor_type"] 
      }, 
      "value": "$cnt", 
      "ts": 1, 
      "_id": 0 
    } 
  }
])
```

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ `examples/Sensor Values Count - Atlas.json`.

---

## üîÑ Template –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

Template –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–µ–ª–∞—é—Ç –≤–∞—à–∏ –¥–∞—à–±–æ—Ä–¥—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏.

<img src="src/img/sample_template.png" alt="Template –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ" style="width: 800px;"/>

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:**

```javascript
// –ü–æ–ª—É—á–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã —Å–µ–Ω—Å–æ—Ä–æ–≤
db.sensor_value.distinct("sensor_type")

// –ü–æ–ª—É—á–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ö–æ—Å—Ç–æ–≤
db.sensor_value.distinct("host_name")

// –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
db.adminCommand({ listDatabases: 1 })
```

–ó–∞–ø—Ä–æ—Å—ã –¥–ª—è template –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–æ–ª–µ–º `_id`.

---

## üõ†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Grafana        ‚îÇ
‚îÇ   Dashboard      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ HTTP (REST API)
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MongoDB Plugin      ‚îÇ
‚îÇ  REST API Proxy      ‚îÇ
‚îÇ  (localhost:3333)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ MongoDB Protocol
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    MongoDB           ‚îÇ
‚îÇ  Atlas / Self-hosted ‚îÇ
‚îÇ  Replica Set / Shard ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. Grafana –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ proxy —Å–µ—Ä–≤–µ—Ä—É
2. Proxy –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ MongoDB aggregation pipeline
3. MongoDB –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
4. Proxy —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è Grafana API
5. Grafana –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–∞—Ö

---

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª—É–∂–±—É Grafana
brew services stop grafana  # Mac —Å Homebrew
# –ò–õ–ò
sudo systemctl stop grafana-server  # Linux

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ Grafana –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
cd debugging
./start_grafana.sh

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ
npm run build

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–∂—ë—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞)
# Cmd+Shift+R (Mac) –∏–ª–∏ Ctrl+Shift+R (Windows/Linux)
```

### –ó–∞–ø—É—Å–∫ –∫–∞–∫ —Å–µ—Ä–≤–∏—Å (Mac)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ forever-mac
npm install -g forever-mac

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ plist —Ñ–∞–π–ª launch agent
cp server/mongodb-grafana-proxy.plist ~/Library/LaunchAgents/

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
cd ~/Library/LaunchAgents
launchctl load mongodb-grafana-proxy

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
forever list
```

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `/usr/local/var/lib/grafana/plugins/mongodb-grafana/dist/server`

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –°—Ç–∞—Ç—å–∏ –Ω–∞ –±–ª–æ–≥–µ [run-as-daemon.ru](https://run-as-daemon.ru):

- üìù **"MongoDB –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: –æ—Ç –±–∞–∑—ã –¥–æ enterprise"** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- üìù **"Grafana –∏ MongoDB: –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏"** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –¥–∞—à–±–æ—Ä–¥–æ–≤
- üìù **"–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è aggregation pipeline –¥–ª—è –¥–∞—à–±–æ—Ä–¥–æ–≤"** - –∫–∞–∫ —É—Å–∫–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –≤ 10 —Ä–∞–∑
- üìù **"Telegram –∞–ª–µ—Ä—Ç—ã –¥–ª—è MongoDB"** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä
- üìù **"–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ sharded clusters"** - –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏

### –¢—É—Ç–æ—Ä–∏–∞–ª—ã:

- üìñ [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ MongoDB Atlas](https://run-as-daemon.ru/mongodb-atlas-grafana) - –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- üìñ [–°–æ–∑–¥–∞–Ω–∏–µ custom –º–µ—Ç—Ä–∏–∫ –¥–ª—è MongoDB](https://run-as-daemon.ru/mongodb-custom-metrics) - —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
- üìñ [High Availability –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](https://run-as-daemon.ru/mongodb-ha-monitoring) - –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- üìñ [Performance tuning MongoDB queries](https://run-as-daemon.ru/mongodb-performance) - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üÜò –¢–∏–ø–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection refused to localhost:3333"

**–†–µ—à–µ–Ω–∏–µ:** 
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ proxy —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
npm run server

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—Ä—Ç 3333 —Å–≤–æ–±–æ–¥–µ–Ω
lsof -i :3333

# –ï—Å–ª–∏ –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç, –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Empty response from datasource"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å MongoDB connection string
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É–∫–∞–∑–∞–Ω–æ –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ:
   ```bash
   mongo "mongodb://localhost:27017/mydb"
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Slow query performance"

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –ø–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ `$match`:
   ```javascript
   db.collection.createIndex({ "ts": 1, "sensor_type": 1 })
   ```
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `$dateBucketCount` –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –∑–∞–ø—Ä–æ—Å–æ–≤
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `$bucketAuto` –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ explain plan –∑–∞–ø—Ä–æ—Å–∞:
   ```javascript
   db.collection.aggregate([...]).explain("executionStats")
   ```

üí° **–ù—É–∂–Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π?** [–ó–∞–∫–∞–∂–∏—Ç–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é ‚Üí](https://run-as-daemon.ru/consultation)

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Authentication failed"

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π authSource
mongodb://user:pass@host:27017/mydb?authSource=admin

// –î–ª—è MongoDB Atlas –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–Ω—ã–π connection string –∏–∑ –ø–∞–Ω–µ–ª–∏ Atlas
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Cannot read property 'aggregate' of undefined"

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —É–∫–∞–∑–∞–Ω–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö data source

---

## ü§ù –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º?

### üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è

–ü–µ—Ä–≤—ã–µ **30 –º–∏–Ω—É—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ** –¥–ª—è:
- ‚úÖ –û—Ü–µ–Ω–∫–∏ —Ç–µ–∫—É—â–µ–π MongoDB –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ –ü–æ–¥–±–æ—Ä–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø–æ–¥ –≤–∞—à–∏ –∑–∞–¥–∞—á–∏
- ‚úÖ –†–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ —Å—Ä–æ–∫–æ–≤ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
- ‚úÖ –û—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã

**–ó–∞–ø–∏—Å–∞—Ç—å—Å—è:** [run-as-daemon.ru/consultation](https://run-as-daemon.ru/consultation)

---

### üì¶ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ —É—Å–ª—É–≥

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Start | Enterprise | Cluster |
|----------|-------|------------|---------|
| **–¶–µ–Ω–∞** | –æ—Ç 20,000‚ÇΩ | –æ—Ç 50,000‚ÇΩ | –æ—Ç 150,000‚ÇΩ |
| **–°—Ä–æ–∫** | 1-2 –¥–Ω—è | 3-5 –¥–Ω–µ–π | 2-4 –Ω–µ–¥–µ–ª–∏ |
| **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Grafana** | ‚úÖ | ‚úÖ | ‚úÖ |
| **–ë–∞–∑–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã** | 3-5 —à—Ç | 5-10 —à—Ç | 15+ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö |
| **–ê–ª–µ—Ä—Ç—ã** | –ë–∞–∑–æ–≤—ã–µ | –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ | Enterprise 24/7 |
| **Replica Set** | ‚ùå | ‚úÖ | ‚úÖ |
| **Sharded Cluster** | ‚ùå | ‚ö†Ô∏è –û–ø—Ü–∏—è | ‚úÖ |
| **Multi-region** | ‚ùå | ‚ùå | ‚úÖ |
| **Custom –º–µ—Ç—Ä–∏–∫–∏** | ‚ùå | ‚ö†Ô∏è –û–ø—Ü–∏—è | ‚úÖ |
| **–û–±—É—á–µ–Ω–∏–µ** | 1 —á–∞—Å | 4 —á–∞—Å–∞ | 8+ —á–∞—Å–æ–≤ |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞** | 1 –Ω–µ–¥–µ–ª—è | 1 –º–µ—Å—è—Ü | 3-12 –º–µ—Å—è—Ü–µ–≤ |
| **SLA** | ‚ùå | ‚ö†Ô∏è –û–ø—Ü–∏—è | ‚úÖ |

---

### üí¨ –ë—ã—Å—Ç—Ä–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

- **üì± Telegram**: –û—Ç–≤–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 1 —á–∞—Å–∞ (—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è)
- **üìß Email**: –û—Ç–≤–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤
- **üìû –ó–≤–æ–Ω–æ–∫**: –ü–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–ø–∏—Å–∏
- **üÜò –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å**: –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å SLA - 24/7

---

## üåü –û—Ç–∑—ã–≤—ã –∫–ª–∏–µ–Ω—Ç–æ–≤

> "–ù–∞—Å—Ç—Ä–æ–∏–ª–∏ –ø–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ MongoDB Atlas –∑–∞ 1 –¥–µ–Ω—å. –¢–µ–ø–µ—Ä—å –≤–∏–¥–∏–º –≤—Å–µ –≤–∞–∂–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ –æ–¥–Ω–æ–º –¥–∞—à–±–æ—Ä–¥–µ. Telegram –∞–ª–µ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑—É–ø—Ä–µ—á–Ω–æ - —É–∑–Ω–∞—ë–º –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Ä–∞–Ω—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π!"  
> **‚Äî –ê–ª–µ–∫—Å–µ–π –ö., CTO —Ñ–∏–Ω—Ç–µ—Ö-—Å—Ç–∞—Ä—Ç–∞–ø–∞**

---

> "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –ø–æ–º–æ–≥–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à–∏ –¥–∞—à–±–æ—Ä–¥—ã. –ß—Ç–æ —Ä–∞–Ω—å—à–µ –∑–∞–≥—Ä—É–∂–∞–ª–æ—Å—å 30 —Å–µ–∫—É–Ω–¥, —Ç–µ–ø–µ—Ä—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. –ü–æ–ª—É—á–∏–ª–∏ –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∑–∞–ø—Ä–æ—Å–æ–≤."  
> **‚Äî –ú–∞—Ä–∏—è –°., DevOps Lead –≤ e-commerce**

---

> "–í—ã–ø–æ–ª–Ω–∏–ª–∏ –ø–æ–ª–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è sharded cluster –∏–∑ 12 —à–∞—Ä–¥–æ–≤. –í—Å—ë —Å–¥–µ–ª–∞–Ω–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ, —Ç–æ—á–Ω–æ –≤ —Å—Ä–æ–∫, —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π. –¢–µ–ø–µ—Ä—å –≤–∏–¥–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞—Ä–¥–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏."  
> **‚Äî –î–º–∏—Ç—Ä–∏–π –í., Senior DBA**

---

> "–û—Ç–ª–∏—á–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç! –ë—ã—Å—Ç—Ä–æ —Ä–∞–∑–æ–±—Ä–∞–ª—Å—è –≤ –Ω–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ, –ø—Ä–µ–¥–ª–æ–∂–∏–ª –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –≤–Ω–µ–¥—Ä–∏–ª –∑–∞ 2 –¥–Ω—è. –¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å –∞–ª–µ—Ä—Ç–∞–º–∏. –†–µ–∫–æ–º–µ–Ω–¥—É—é!"  
> **‚Äî –°–µ—Ä–≥–µ–π –ü., Backend Team Lead**

[**–ë–æ–ª—å—à–µ –æ—Ç–∑—ã–≤–æ–≤ ‚Üí**](https://run-as-daemon.ru/reviews)

---

## üìû –ó–∞–∫–∞–∑–∞—Ç—å —É—Å–ª—É–≥–∏

<div align="center">

### üöÄ –ì–æ—Ç–æ–≤—ã —É–ª—É—á—à–∏—Ç—å MongoDB –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥?

**–°–≤—è–∂–∏—Ç–µ—Å—å –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞**

[üåê run-as-daemon.ru](https://run-as-daemon.ru) | 
[üìß Email](mailto:contact@run-as-daemon.ru) | 
[üí¨ Telegram](https://t.me/run_as_daemon)

---

### üéØ –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ

**–ü—Ä–∏ –∑–∞–∫–∞–∑–µ –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞:**
- ‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è** —Å –¥—Ä—É–≥–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ **+2 –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–∞** –≤ –ø–æ–¥–∞—Ä–æ–∫
- ‚úÖ **1 –º–µ—Å—è—Ü —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏** –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- ‚úÖ **–°–∫–∏–¥–∫–∞ 10%** –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ –ø–æ–ª–Ω–æ–π —Å—É–º–º—ã

</div>

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

**–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç:** [JamesOsgood/mongodb-grafana](https://github.com/JamesOsgood/mongodb-grafana)

**–§–æ—Ä–∫ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏ –æ—Ç:** [run-as-daemon.ru](https://run-as-daemon.ru)

---

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- **James Osgood** - –∞–≤—Ç–æ—Ä –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ MongoDB datasource plugin
- **Grafana Community** - –∑–∞ –æ—Ç–ª–∏—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- **MongoDB Team** - –∑–∞ –º–æ—â–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏
- –í—Å–µ –∫–æ–Ω—Ç—Ä–∏–±—å—é—Ç–æ—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

---

## ‚≠ê –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

–ï—Å–ª–∏ –ø–ª–∞–≥–∏–Ω –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º:
- ‚≠ê **–ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É** –Ω–∞ GitHub
- üìù **–ù–∞–ø–∏—à–∏—Ç–µ –æ—Ç–∑—ã–≤** –æ —Å–≤–æ—ë–º –æ–ø—ã—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- üí¨ **–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –∫–æ–ª–ª–µ–≥–∞–º** - –ø–æ–º–æ–≥–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç—É —Ä–∞—Å—Ç–∏
- üêõ **–°–æ–æ–±—â–∞–π—Ç–µ –æ –±–∞–≥–∞—Ö** - –ø–æ–º–æ–≥–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å –ø–ª–∞–≥–∏–Ω –ª—É—á—à–µ
- üí° **–ü—Ä–µ–¥–ª–∞–≥–∞–π—Ç–µ –∏–¥–µ–∏** - –≤–∞—à–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è –≤–∞–∂–Ω—ã
- ‚òï **[–£–≥–æ—Å—Ç–∏—Ç–µ –∫–æ—Ñ–µ](https://www.buymeacoffee.com/runasdaemon)** - –ø–æ–¥–¥–µ—Ä–∂–∏—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É

---

<div align="center">

**Made with ‚ù§Ô∏è by [run-as-daemon.ru](https://run-as-daemon.ru)**

*–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π DevOps ‚Ä¢ –°–∏—Å—Ç–µ–º–Ω–æ–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Ä¢ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥*

*MongoDB ‚Ä¢ Grafana ‚Ä¢ Prometheus ‚Ä¢ Kubernetes ‚Ä¢ Docker ‚Ä¢ CI/CD*

---

[‚¨Ü –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#-mongodb-datasource-–¥–ª—è-grafana)

</div>
